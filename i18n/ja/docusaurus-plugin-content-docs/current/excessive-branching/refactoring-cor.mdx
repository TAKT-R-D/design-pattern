import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";
import CodeBlock from "@theme/CodeBlock";

import tsCode from "@site/src/codes/excessive-branching/ts/rfc_cor.ts";
import phpCode from "@site/src/codes/excessive-branching/php/rfc_cor.php";
import pyCode from "@site/src/codes/excessive-branching/py/rfc_cor.py";

# ğŸ§© Chain of Resp. ãƒ‘ã‚¿ãƒ¼ãƒ³

## âœ… è¨­è¨ˆæ„å›³

- è¤‡æ•°ã®å‡¦ç†ã‚¯ãƒ©ã‚¹ã‚’é€£é–ã•ã›ã€**æ¡ä»¶ã«å¿œã˜ã¦èª°ãŒå‡¦ç†ã™ã‚‹ã‹ã‚’å§”è­²**
- å„å‡¦ç†ã‚¯ãƒ©ã‚¹ã¯ã€Œå‡¦ç†ã™ã‚‹ or æ¬¡ã«æ¸¡ã™ã€

## âœ… é©ç”¨ç†ç”±

- åˆ†å²å‡¦ç†ã‚’**ç›´åˆ—ã®å‡¦ç†ãƒã‚§ãƒ¼ãƒ³ã«å¤‰æ›**
- å‡¦ç†ã®æµã‚Œã‚’é †ã«ç¢ºèªã—ãŸã„ã¨ãã«æœ€é©

## âœ… å‘ã„ã¦ã„ã‚‹ã‚·ãƒ¼ãƒ³

- å„å‡¦ç†ãŒç‹¬ç«‹ã—ã¦ã„ã¦ã€**ã©ã“ã‹ã§å‡¦ç†ãŒæ­¢ã¾ã‚‹**
- è¤‡æ•°æ¡ä»¶ã®ä¸­ã§ã€Œè©²å½“ã™ã‚‹ 1 ã¤ã€ã«ä»»ã›ãŸã„

## âœ… ã‚³ãƒ¼ãƒ‰ä¾‹

<Tabs groupId="language">
  <TabItem value="ts" label="TypeScript">
    <CodeBlock language="ts">{tsCode}</CodeBlock>
  </TabItem>
  <TabItem value="php" label="PHP">
    <CodeBlock language="php">{phpCode}</CodeBlock>
  </TabItem>
  <TabItem value="python" label="Python">
    <CodeBlock language="python">{pyCode}</CodeBlock>
  </TabItem>
</Tabs>

## âœ… è§£èª¬

ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ `Chain of Responsibility (CoR)` ãƒ‘ã‚¿ãƒ¼ãƒ³ ã‚’ä½¿ç”¨ã—ã¦ã€å‰²å¼•è¨ˆç®—ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’ä¸€é€£ã®ãƒãƒ³ãƒ‰ãƒ©ã«åˆ†å‰²ã—ã€
ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é †ã«å‡¦ç†ã™ã‚‹è¨­è¨ˆã‚’å®Ÿç¾ã—ã¦ã„ã‚‹ã€‚`CoR` ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ã€è¤‡æ•°ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒé€£é–çš„ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å‡¦ç†ã—ã€
é©åˆ‡ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒå‡¦ç†ã‚’æ‹…å½“ã™ã‚‹ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã€‚

### 1. Chain of Responsibility ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ¦‚è¦

- **Handler**: ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å‡¦ç†ã™ã‚‹ãŸã‚ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®šç¾©
  - ã“ã®ã‚³ãƒ¼ãƒ‰ã§ã¯ `DiscountHandler` ãŒè©²å½“
- **ConcreteHandler**: `Handler` ã‚’å®Ÿè£…ã—ã€ç‰¹å®šã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å‡¦ç†ã™ã‚‹ã‚¯ãƒ©ã‚¹
  - ã“ã®ã‚³ãƒ¼ãƒ‰ã§ã¯ `StudentHandler`, `MemberHandler`, `VIPHandler` ãŒè©²å½“
- **Client**: ãƒãƒ³ãƒ‰ãƒ©ãƒã‚§ãƒ¼ãƒ³ã‚’æ§‹ç¯‰ã—ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æœ€åˆã®ãƒãƒ³ãƒ‰ãƒ©ã«æ¸¡ã™
  - ã“ã®ã‚³ãƒ¼ãƒ‰ã§ã¯ `student.setNext(member).setNext(vip)` ã®éƒ¨åˆ†ãŒè©²å½“

### 2. ä¸»ãªã‚¯ãƒ©ã‚¹ã¨ãã®å½¹å‰²

- `DiscountHandler`
  - ãƒãƒ³ãƒ‰ãƒ©ã®å…±é€šã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
  - `setNext(handler: DiscountHandler): DiscountHandler` ãƒ¡ã‚½ãƒƒãƒ‰ã§æ¬¡ã®ãƒãƒ³ãƒ‰ãƒ©ã‚’è¨­å®š
  - `handle(userType: string, basePrice: number): number` ãƒ¡ã‚½ãƒƒãƒ‰ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å‡¦ç†
- `BaseDiscountHandler`
  - `DiscountHandler` ã‚’å®Ÿè£…ã—ãŸæŠ½è±¡ã‚¯ãƒ©ã‚¹
  - å…±é€šã® `setNext` ãƒ¡ã‚½ãƒƒãƒ‰ã¨ã€æ¬¡ã®ãƒãƒ³ãƒ‰ãƒ©ã«å‡¦ç†ã‚’å§”è­²ã™ã‚‹ `handle` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æä¾›
- `StudentHandler`, `MemberHandler`, `VIPHandler`
  - `BaseDiscountHandler` ã‚’ç¶™æ‰¿ã—ãŸå…·ä½“çš„ãªãƒãƒ³ãƒ‰ãƒ©ã‚¯ãƒ©ã‚¹
  - å„ã‚¯ãƒ©ã‚¹ã§ç‰¹å®šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚¤ãƒ—ï¼ˆ`student`, `member`, `vip`ï¼‰ã«å¿œã˜ãŸå‰²å¼•ãƒ­ã‚¸ãƒƒã‚¯ã‚’å®Ÿè£…
- ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ¼ãƒ‰
  - ãƒãƒ³ãƒ‰ãƒ©ãƒã‚§ãƒ¼ãƒ³ã‚’æ§‹ç¯‰ã—ã€æœ€åˆã®ãƒãƒ³ãƒ‰ãƒ©ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æ¸¡ã™

### 3. UML ã‚¯ãƒ©ã‚¹å›³

```mermaid
classDiagram
    class DiscountHandler {
        <<interface>>
        +setNext(handler: DiscountHandler): DiscountHandler
        +handle(userType: string, basePrice: number): number
    }

    class BaseDiscountHandler {
        -nextHandler: DiscountHandler
        +setNext(handler: DiscountHandler): DiscountHandler
        +handle(userType: string, basePrice: number): number
    }

    class StudentHandler {
        +handle(userType: string, basePrice: number): number
    }

    class MemberHandler {
        +handle(userType: string, basePrice: number): number
    }

    class VIPHandler {
        +handle(userType: string, basePrice: number): number
    }

    DiscountHandler <|.. BaseDiscountHandler
    BaseDiscountHandler <|-- StudentHandler
    BaseDiscountHandler <|-- MemberHandler
    BaseDiscountHandler <|-- VIPHandler
    BaseDiscountHandler o-- DiscountHandler : nextHandler
```

### 4. Chain of Responsibility ãƒ‘ã‚¿ãƒ¼ãƒ³ã®åˆ©ç‚¹

- **æŸ”è»Ÿãªå‡¦ç†ãƒ•ãƒ­ãƒ¼**: ãƒãƒ³ãƒ‰ãƒ©ã®é †åºã‚’å‹•çš„ã«å¤‰æ›´å¯èƒ½
- **å˜ä¸€è²¬ä»»ã®åŸå‰‡**: å„ãƒãƒ³ãƒ‰ãƒ©ãŒç‰¹å®šã®å‡¦ç†ã«ã®ã¿è²¬ä»»ã‚’æŒã¤
- **æ‹¡å¼µæ€§**: æ–°ã—ã„ãƒãƒ³ãƒ‰ãƒ©ã‚’è¿½åŠ ã™ã‚‹å ´åˆã‚‚ã€æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰ã«å½±éŸ¿ã‚’ä¸ãˆãšã«å¯¾å¿œå¯èƒ½

ã“ã®è¨­è¨ˆã¯ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æŸ”è»Ÿã«å‡¦ç†ã—ã€æ¡ä»¶åˆ†å²ã‚’æ’é™¤ã™ã‚‹ã€‚ç‰¹ã«ã€å‡¦ç†ã®æµã‚Œã‚’å‹•çš„ã«å¤‰æ›´ã—ãŸã„å ´åˆã‚„ã€
è¤‡æ•°ã®æ¡ä»¶ã«åŸºã¥ãå‡¦ç†ãŒå¿…è¦ãªå ´é¢ã§æœ‰åŠ¹ã«æ©Ÿèƒ½ã™ã‚‹ã€‚
