# 🧩 Architecture Principles（アーキテクチャ原則）

ソフトウェアアーキテクチャは個々のスタイルや技法の集合ではなく、基盤となる「原則（Principles）」によって支えられる。本ページでは、スタイルを横断して共通に働く主要なアーキテクチャ原則を体系的に整理する。

## ✅ 依存方向の原則（Dependency Direction）

アーキテクチャにおける最重要原則のひとつは、**依存がどちらの方向へ向くか** を意図的に設計することである。

- 上位レイヤ（Policy） → 下位レイヤ（Detail）への依存を避ける
- 具体実装は抽象インターフェースに従う（DIP: Dependency Inversion Principle）
- Hexagonal / Onion / Clean Architecture などはこの原則を中核に据える

依存方向は、変更容易性・テスト容易性・モジュール性に直接影響する。

## ✅ 結合度と凝集度（Coupling & Cohesion）

健全な設計の基本要素として次がある：

- **低結合（Low Coupling）**：他コンポーネントへの依存を最小化する
- **高凝集（High Cohesion）**：ひとつのモジュールが一貫した責務を持つ

結合度・凝集度はすべての構造スタイルに関係し、トップロジー（Microservices / Modular Monolith）にも影響を与える。

## ✅ 境界（Boundaries）とコンテキスト

アーキテクチャでは、どこに境界（Boundary）を引くかが最も重要な意思決定のひとつである。

- 境界づけられたコンテキスト（Bounded Context）
- インターフェース / ポートによる境界定義
- チーム境界との整合（Conway's Law）

境界の設計は、システムのスケール性と変更容易性を左右する。

## ✅ 同期 vs 非同期（Sync / Async）

通信方式の違いは構造全体に影響を与える。

- **同期**：REST/gRPC、リクエスト応答型
- **非同期**：イベント駆動、ストリーム処理、メッセージング

可用性・待ち時間・整合性要求に応じて適切な方式を選択する必要がある。

## ✅ 整合性モデル（Consistency Models）

データ中心の設計で重要となるポイント：

- **強整合（Strong Consistency）**
- **最終的整合性（Eventual Consistency）**
- **規模に応じたトレードオフ（CAP / PACELC）**

CQRS や Event Sourcing、Microservices は整合性モデルの理解を前提とする。

## ✅ Essential Complexity と Accidental Complexity

システムの複雑性には 2 種類がある：

- **本質的複雑性（Essential Complexity）**：ドメインそのものの複雑さ
- **偶発的複雑性（Accidental Complexity）**：技術選定や設計によって増える不要な複雑さ

優れたアーキテクチャは偶発的複雑性を削減し、本質的価値に集中できる構造を実現する。

## ✅ 設計の重心（Operational / Domain / Data）

アーキテクチャは次の重心のどれを優先するかで変化する：

- Operational（可用性・レジリエンス・監視）
- Domain（ドメインモデル表現）
- Data（データ中心・分析ワークロード）

どこに重心を置くかで、スタイル選定やトップロジーが自然に導かれる。

## ✅ まとめ

アーキテクチャ原則は、スタイルやフレームワークよりも上位の概念であり、  
**どのスタイルを採用しても一貫して適用される普遍的ルール** である。

これらの原則を理解することで、個々のスタイルを「選ぶ」のではなく、  
**目的に応じて設計意図を組み立てるための基盤** が身につく。
