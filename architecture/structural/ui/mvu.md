# 🧩 MVU（Model-View-Update / Elm Architecture）

## ✅ このスタイルの概要

**状態（Model）と画面（View）、状態更新（Update）を純粋関数とメッセージで結びつける UI 構造スタイル。**  
Elm によって有名になり、関数型フロントエンドの代表的アプローチとなった。

## ✅ 解決しようとした問題

MVVM まで来ても、次のような課題があった：

- 双方向バインディングが複雑になると状態の流れが追いにくい
- ViewModel が肥大化し、どこで何が変更されているか分かりづらい
- 非同期処理やイベントが増えるとロジックが分散する

MVU は、

> 「状態は 1 箇所に集約し、  
>  すべての更新はメッセージを介して単一の Update 関数で扱う」

というシンプルな原則でこれに応える。

## ✅ 基本思想・ルール

### ● Model

- アプリケーションの状態を表すレコード / オブジェクト

### ● View

- `view : Model -> Html Msg` のように、状態から UI（仮想 DOM）を生成する純粋関数
- ユーザー操作は `Msg`（メッセージ）として表現される

### ● Update

- `update : Msg -> Model -> Model` のように、  
  メッセージと現在の状態を受け取り、次の状態を返す純粋関数

### ● ループ構造

- Model をもとに View を描画
- ユーザー操作等から Msg が発生
- Update が新しい Model を返す
- 再度 View を描画

このループを回し続けることで UI が動作します。

## ✅ 得意なアプリケーション

- Elm や PureScript などの関数型フロントエンド
- Redux / TEA（The Elm Architecture）に影響を受けた React アプリ
- 状態遷移が多く、イベント駆動の UI

特徴：

- 状態の流れ（データフロー）が非常に明瞭
- デバッグ・タイムトラベルがしやすい

## ❌ 不向きなケース

- 関数型スタイルに慣れていないチーム
- 小さなフォーム中心の画面だけのアプリ（オーバーヘッドになりうる）

また、すべてを MVU に当てはめようとすると：

- Update 関数が肥大化する
- メッセージの種類が増えすぎる

といった課題もある。

## ✅ 歴史（系譜・親スタイル）

- Elm 言語が提唱したアーキテクチャ
- Redux や React Hooks など、多くのフロントエンド技術に影響
- MVVM / Flux などと同じく、UI 状態管理の一つの流派として広く認識されている

## ✅ 関連スタイル

- **MVVM**：バインディングベースの UI 構造
- **Flux / Redux**：単一ストア＋リデューサーという構造が MVU に近い
- **FRP / Reactive Streams**：イベントストリームとしての UI モデル

## ✅ 代表的なフレームワーク

MVU（The Elm Architecture）は、関数型・宣言的 UI の世界で広く影響を与えている。

- **Elm**  
  MVU の元祖となった言語／フレームワーク。`Model` / `View` / `Update` の構造が明示されている。

- **React + Redux**  
  単一ストアと Reducer による状態更新は、MVU の影響を強く受けている。

- **React Hooks（useReducer など）**  
  `state` と `dispatch` による更新フローは、MVU 的な発想に近い。

- **SwiftUI / Jetpack Compose**  
  単一方向データフローと宣言的 UI により、MVU に近いスタイルで UI を構築できる。

## ✅ このスタイルを支えるデザインパターン

MVU は形式的には関数型の構造ですが、オブジェクト指向のデザインパターンで見ると次の要素が強く現れる。

- **State**  
  単一の Model にアプリケーション状態を集約し、その変化によって振る舞いを変える。

- **Command**  
  `Msg`（メッセージ）を「操作オブジェクト」として扱い、Update 関数で解釈する。

- **Observer**  
  状態が変わるたびに View が再計算されるという意味で、Model → View の通知的な構造を持つ。

## ✅ まとめ

MVU は、

- 単一の状態
- 純粋関数による更新
- 宣言的な View

というシンプルなルールで UI を組み立てるスタイルである。

状態管理が複雑になりがちなモダンフロントエンドにおいて、  
**「すべての変更はメッセージを通じて単一の Update に集約する」** という発想は、  
他のフレームワークやパターンにも大きな影響を与え続けている。
